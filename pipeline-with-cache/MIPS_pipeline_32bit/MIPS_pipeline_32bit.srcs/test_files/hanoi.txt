# hanoi
# in this program, it calculate hanoi(3,a,b,c)=7, and store the result in $s0, and in the end $t0=$s0=7
# and print out the sequence of moving disk in data memory: ac,ab,cb,ac,ba,bc,ac

#		Assembly			Description				Address		Machine		Binary

# main
main:	addi $29, $0, 127	# $sp = 508(4*127)		0			201d01fc	001000 00000 11101 0000 0001 1111 1100
		
		addi $16, $0, 0		# $s0 = 0(count)		4			20100000	001000 00000 10000 0000 0000 0000 0000
		addi $28, $0, 0		# $gp=0(output pointer)	8			201c0000	001000 00000 11100 0000 0000 0000 0000
		
		addi $4, $0, 3		# $a0 = 3				c			20040003	001000 00000 00100 0000 0000 0000 0011
		addi $5, $0, a		# $a1 = a				10			2005000a	001000 00000 00101 0000 0000 0000 1010
		addi $6, $0, b		# $a2 = b				14			2006000b	001000 00000 00110 0000 0000 0000 1011
		addi $7, $0, c		# $a3 = c				18			2007000c	001000 00000 00111 0000 0000 0000 1100
		jal  hanoi			# call hanoi			1c			0c00000a	000011 000000 0000 0000 0000 0000 1010
		nop					# no operation			20			00000000
		
		j	 end			# jump end				24			08000035    000010 000000 0000 0000 0000 0011 0101
		
hanoi:	addi $29, $29, -20	# $sp = $sp - 20		28			23bdffec	001000 11101 11101 1111 1111 1110 1100
		sw	 $31, 0($29)	# [$sp] = $ra			2c			afbf0000	101011 11101 11111 0000 0000 0000 0000
		sw	 $4, 4($29)		# [$sp + 4] = $a0		30			afa40004	101011 11101 00100 0000 0000 0000 0100
		sw	 $5, 8($29)		# [$sp + 8] = $a1		34			afa50008	101011 11101 00101 0000 0000 0000 1000
		sw	 $6, 12($29)	# [$sp + 12] = $a2		38			afa6000c	101011 11101 00110 0000 0000 0000 1100
		sw	 $7, 16($29)	# [$sp + 16] = $a3		3c			afa70010	101011 11101 00111 0000 0000 0001 0000
		
		slti $8, $4, 3		# $t0 = $a0 < 2			40			28880002	001010 00100 01000 0000 0000 0000 0010
		beq	 $8, $0, else	# no: goto else			44			11000007	000100 01000 00000 0000 0000 0000 0111
		
		addi $16, $16, 1	# $s0 = $s0 + 1(count)	48			22100001	001000 10000 10000 0000 0000 0000 0001
		sll	 $8, $5, 4		# $t0 = $a2 << 4		4c			00054100	000000 00000 00101 01000 00100 000000
		add  $8, $8, $7		# $t0 = $t0 + $a3		50			01074020	000000 01000 00111 01000 00000 100000
		sw	 $8, 0($28)		# [$gp] = $t0			54			af880000	101011 11100 01000 0000 0000 0000 0000
		addi $28, $28, 4	# $gp = $gp + 4			58			239c0004	001000 11100 11100 0000 0000 0000 0100
		
		addi $29, $29, 20	# $sp = $sp + 20		5c			23bd0014	001000 11101 11101 0000 0000 0001 0100
		jr	 $31			# return				60			03e00008	000000 11111 0000000000 00000 001000
		
	else:		
		addi $4, $4, -1		# $a0 = $a0 - 1			64			2084ffff	001000 00100 00100 1111 1111 1111 1111
		add  $8, $6, $0		# $t0 = $a2				68			00c04020	000000 00110 00000 01000 00000 100000
		add  $6, $7, $0		# $a2 = $a3				6c			00e03020	000000 00111 00000 00110 00000 100000
		add  $7, $8, $0		# $a3 = $t0				70			01003820	000000 01000 00000 00111 00000 100000
		jal  hanoi			# call hanoi			1c			0c00000a	000011 000000 0000 0000 0000 0000 1010
		nop					# no operation			78			00000000
		
		lw	 $4, 4($29)		# $a0 = [$sp + 4] 		7c			8fa40004	100011 11101 00100 0000 0000 0000 0100
		addi $4, $4, -1		# $a0 = $a0 - 1			80			2084ffff	001000 00100 00100 1111 1111 1111 1111
		lw	 $5, 8($29)		# $a1 = [$sp + 8] 		84			8fa50008	100011 11101 00101 0000 0000 0000 1000
		lw	 $6, 12($29)	# $a2 = [$sp + 12] 		88			8fa6000c	100011 11101 00110 0000 0000 0000 1100
		lw	 $7, 16($29)	# $a3 = [$sp + 16] 		8c			8fa70010	100011 11101 00111 0000 0000 0001 0000
		
		addi $16, $16, 1	# $s0 = $s0 + 1(count)	90			22100001	001000 10000 10000 0000 0000 0000 0001
		sll	 $8, $5, 4		# $t0 = $a2 << 4		94			00054100	000000 00000 00101 01000 00100 000000
		add  $8, $8, $7		# $t0 = $t0 + $a3		98			01074020	000000 01000 00111 01000 00000 100000
		sw	 $8, 0($28)		# [$gp] = $t0			9c			af880000	101011 11100 01000 0000 0000 0000 0000
		addi $28, $28, 4	# $gp = $gp + 4			a0			239c0004	001000 11100 11100 0000 0000 0000 0100		
		
		add  $8, $6, $0		# $t0 = $a2				a4			00c04020	000000 00110 00000 01000 00000 100000
		add  $6, $5, $0		# $a2 = $a1				a8			00a03020	000000 00101 00000 00110 00000 100000
		add  $5, $8, $0		# $a1 = $t0				ac			01002820	000000 01000 00000 00101 00000 100000
		jal  hanoi			# call hanoi			b0			0c00000a	000011 000000 0000 0000 0000 0000 1010
		nop					# no operation			b4			00000000
		
		lw	 $31, 0($29)	# $ra = [$sp]			b8			8fbf0000	100011 11101 11111 0000 0000 0000 0000
		lw	 $4, 4($29)		# $a0 = [$sp + 4] 		bc			8fa40004	100011 11101 00100 0000 0000 0000 0100
		lw	 $5, 8($29)		# $a1 = [$sp + 8] 		c0			8fa50008	100011 11101 00101 0000 0000 0000 1000
		lw	 $6, 12($29)	# $a2 = [$sp + 12] 		c4			8fa6000c	100011 11101 00110 0000 0000 0000 1100
		lw	 $7, 16($29)	# $a3 = [$sp + 16] 		c8			8fa70010	100011 11101 00111 0000 0000 0001 0000
		addi $29, $29, 20	# $sp = $sp + 20		cc			23bd0014	001000 11101 11101 0000 0000 0001 0100
		jr	 $31			# return				d0			03e00008	000000 11111 0000000000 00000 001000

end:	addi $8, $16, 0		# $t0 = $s0	+ $0		d4			22080000	001000 10000 01000 0000 0000 0000 0000


