# fibonacci: fibon(n) = fibon(n-1) + fibon(n-2), and fibon(2)=fibon(1)=1
# in this program, it calculate fibonacci(10)=55=0x37, and in the end $t0 = $v0 = 0x37

#		Assembly			Description				Address		Machine		Binary

# main
main:	addi $29, $0, 127	# $sp = 508(4*127)		0			201d01fc	001000 00000 11101 0000 0001 1111 1100
		
		addi $4, $0, 10		# $a0 = 10				4			2004000a	001000 00000 00100 0000 0000 0000 1010
		jal  fibon			# call fibon			8			0c000005	000011 000000 0000 0000 0000 0000 0101
		nop					# no operation			c			00000000
		
		j	 end			# jump end				10			0800001a    000010 000000 0000 0000 0000 0001 1010
		
fibon:	addi $29, $29, -8	# $sp = $sp - 8			14			23bdfff8	001000 11101 11101 1111 1111 1111 1000
		sw	 $31, 0($29)	# [$sp] = $ra			18			afbf0000	101011 11101 11111 0000 0000 0000 0000
		sw	 $4, 4($29)		# [$sp + 4] = $a0		1c			afa40004	101011 11101 00100 0000 0000 0000 0100
		
		slti $8, $4, 3		# $t0 = $a0 < 3			20			28880003	001010 00100 01000 0000 0000 0000 0011
		beq	 $8, $0, else	# no: goto else			24			11000003	000100 01000 00000 0000 0000 0000 0011
		addi $2, $0, 1		# yes: return 1			28			20020001	001000 00000 00010 0000 0000 0000 0001
		addi $29, $29, 8	# $sp = $sp + 8			2c			23bd0008	001000 11101 11101 0000 0000 0000 1000
		jr	 $31			# return				30			03e00008	000000 11111 0000000000 00000 001000
		
	else:		
		addi $4, $4, -1		# $a0 = $a0 - 1			34			2084ffff	001000 00100 00100 1111 1111 1111 1111
		jal  fibon			# recursive call fibon	38			0c000005	000011 000000 0000 0000 0000 0000 0101
		nop					# no operation			3c			00000000
		
		lw	 $4, 4($29)		# $a0 = [$sp + 4] 		40			8fa40004	100011 11101 00100 0000 0000 0000 0100
		sw	 $2, 4($29)		# [$sp + 4] = $v0		44			afa20004	101011 11101 00010 0000 0000 0000 0100
		
		addi $4, $4, -2		# $a0 = $a0 - 2			48			2084fffe	001000 00100 00100 1111 1111 1111 1110
		jal  fibon			# recursive call fibon	4c			0c000005	000011 000000 0000 0000 0000 0000 0101
		nop					# no operation			50			00000000
		
		lw	 $31, 0($29)	# $ra = [$sp]			54			8fbf0000	100011 11101 11111 0000 0000 0000 0000
		lw	 $8, 4($29)		# $t0 = [$sp + 4] 		58			8fa80004	100011 11101 01000 0000 0000 0000 0100
		addi $29, $29, 8	# $sp = $sp + 8			5c			23bd0008	001000 11101 11101 0000 0000 0000 1000
		
		add  $2, $8, $2		# $v0 = $t0 + $v0		60			01021020	000000 01000 00010 00010 00000 100000
		jr	 $31			# return				64			03e00008	000000 11111 0000000000 00000 001000

end:	addi $8, $2, 0		# $t0 = $v0	+ $0		68			20480000	001000 00010 01000 0000 0000 0000 0000


